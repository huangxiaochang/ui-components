import{defineComponent as e,ref as t,getCurrentInstance as o,computed as n,provide as l,onMounted as s,isRef as a,openBlock as r,createBlock as u,renderSlot as i,inject as d,onBeforeUnmount as c,reactive as p,watch as m,unref as h,h as v,Transition as f,withCtx as b,withDirectives as g,vShow as y,Comment as k,Fragment as M,cloneVNode as x,onActivated as C,onDeactivated as S,toDisplayString as I,Teleport as w,onBeforeMount as T,resolveComponent as E,createVNode as B}from"vue";import P from"mitt";import{createPopper as O}from"@popperjs/core";import A from"dayjs";const N="Tab",z="Enter",L="Space",H="ArrowUp",_="ArrowDown",$="Escape",D=function(e,t,...o){let n;n=t.includes("mouse")||t.includes("click")?"MouseEvents":t.includes("key")?"KeyboardEvent":"HTMLEvents";const l=document.createEvent(n);return l.initEvent(t,...o),e.dispatchEvent(l),e};class j{constructor(e,t){this.parent=e,this.domNode=t,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){const e=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,(t=>{t.addEventListener("keydown",(t=>{let o=!1;switch(t.code){case _:this.gotoSubIndex(this.subIndex+1),o=!0;break;case H:this.gotoSubIndex(this.subIndex-1),o=!0;break;case N:D(e,"mouseleave");break;case z:case L:o=!0,t.currentTarget.click()}return o&&(t.preventDefault(),t.stopPropagation()),!1}))}))}}class F{constructor(e){this.domNode=e,this.submenu=null,this.submenu=null,this.init()}init(){this.domNode.setAttribute("tabindex","0");const e=this.domNode.querySelector(".hkust-menu");e&&(this.submenu=new j(this,e)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",(e=>{let t=!1;switch(e.code){case _:D(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),t=!0;break;case H:D(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),t=!0;break;case N:D(e.currentTarget,"mouseleave");break;case z:case L:t=!0,e.currentTarget.click()}t&&e.preventDefault()}))}}class R{constructor(e){this.domNode=e,this.init()}init(){const e=this.domNode.childNodes;[].filter.call(e,(e=>1===e.nodeType)).forEach((e=>{new F(e)}))}}var V=e({name:"HkustMenu",componentName:"HkustMenu",props:{mode:{type:String,default:"vertical"},defaultActive:{type:String,default:""},router:Boolean,defaultOpeneds:Array,collapse:Boolean,textColor:{type:String},activeTextColor:{type:String},backgroundColor:{type:String},hoverBackgroundColor:{type:String},uniqueOpened:Boolean,menuTrigger:{type:String,default:"hover"},offset:{type:Number,default:2},placement:String,showTimeout:Number,hideTimeout:Number,collapseTransition:{type:Boolean,default:!0}},emits:["close","open","select"],setup(e,r){const u=t(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),i=o(),d=t(e.defaultActive),c=t({}),p=t({}),m=P(),h=i.appContext.config.globalProperties.$router,v=n((()=>"horizontal"===e.mode||"vertical"===e.mode&&e.collapse)),f=(t,o)=>{u.value.includes(t)||(e.uniqueOpened&&(u.value=u.value.filter((e=>-1!==(a(o)?o.value:o).indexOf(e)))),u.value.push(t))},b=e=>{const t=u.value.indexOf(e);-1!==t&&u.value.splice(t,1)},g=e=>{const{index:t,indexPath:o}=e;u.value.includes(t)?(b(t),r.emit("close",t,o.value)):(f(t,o),r.emit("open",t,o.value))},y=t=>{const{index:o,indexPath:n}=t,l=null!==t.index,s=d.value;if(l&&(d.value=t.index),r.emit("select",o,n.value,t),("horizontal"===e.mode||e.collapse)&&(u.value=[]),e.router&&h&&l){let e=t.route||t.index;try{null==h||h.push(e,(()=>null),(e=>{if(d.value=s,e){if("NavigationDuplicated"===e.name)return;console.error(e)}}))}catch(e){console.error(e)}}};return l("rootMenu",{props:e,openedMenus:u,items:c,submenus:p,activeIndex:d,isMenuPopup:v,methods:{addMenuItem:e=>{c.value[e.index]=e},removeMenuItem:e=>{delete c.value[e.index]},addSubMenu:e=>{p.value[e.index]=e},removeSubMenu:e=>{delete p.value[e.index]},openMenu:f,closeMenu:b},rootMenuEmit:m.emit,rootMenuOn:m.on}),l(`submenu:${i.uid}`,{addSubMenu:()=>null,removeSubMenu:()=>null,handleMouseleave:()=>null,addMenuItem:()=>null,removeMenuItem:()=>null}),s((()=>{(()=>{const t=d.value,o=c.value[t];if(!o||"horizontal"===e.mode||e.collapse)return;o.indexPath.forEach((e=>{let t=p.value[e];t&&f(e,null==t?void 0:t.indexPath)}))})(),m.on("menuItem:item-click",y),m.on("submenu:submenu-click",g),"horizontal"===e.mode&&new R(i.vnode.el)})),{props:e,open:e=>{const{indexPath:t}=p.value[e.toString()];t.forEach((e=>f(e,t)))},close:e=>{b(e)}}}});V.render=function(e,t,o,n,l,s){return r(),u("ul",{key:+e.props.collapse,role:"menubar",style:{backgroundColor:e.props.backgroundColor||""},class:{"hkust-menu":!0,"hkust-menu--horizontal":"horizontal"===e.mode,"hkust-menu--collapse":e.props.collapse}},[i(e.$slots,"default")],6)},V.__file="packages/menu/src/index.vue",V.install=e=>{e.component(V.name,V)};const q=V;function K(e,t){const o=d("rootMenu");return{indexPath:n((()=>{let o=e.parent;const n=[t];for(;"HkustMenu"!==o.type.name;)o.props.index&&n.unshift(o.props.index),o=o.parent;return n})),parentMenu:n((()=>{let t=e.parent;for(;t&&-1===["HkustMenu","HkustSubmenu"].indexOf(t.type.name);)t=t.parent;return t})),paddingStyle:n((()=>{let t=e.parent;if("vertical"!==o.props.mode)return{};let n=20;if(o.props.collapse)n=20;else for(;t&&"HkustMenu"!==t.type.name;)"HkustSubmenu"===t.type.name&&(n+=20),t=t.parent;return{paddingLeft:n+"px"}}))}}var U=e({name:"HkustMenuItem",componentName:"HkustMenuItem",props:{disabled:Boolean,index:{default:null,validator:e=>"string"==typeof e||null===e},route:[String,Object]},emits:["click"],setup(e,{emit:t}){const l=o(),{parentMenu:a,paddingStyle:r,indexPath:u}=K(l,e.index),i=d("rootMenu"),p=d(`submenu:${a.value.uid}`),m=n((()=>e.index===i.activeIndex.value)),h=n((()=>i.props.hoverBackgroundColor)),v=n((()=>i.props.backgroundColor||"")),f=n((()=>i.props.activeTextColor||"")),b=n((()=>i.props.textColor||"")),g=n((()=>({color:m.value?f.value:b.value}))),y=n((()=>i.props.mode));return s((()=>{p&&p.addMenuItem({index:e.index,indexPath:u,active:m}),i.methods.addMenuItem({index:e.index,indexPath:u,active:m})})),c((()=>{p&&p.removeMenuItem({index:e.index,indexPath:u,active:m}),i.methods.removeMenuItem({index:e.index,indexPath:u,active:m})})),{active:m,itemStyle:g,paddingStyle:r,backgroundColor:v,handleClick:()=>{e.disabled||(i.rootMenuEmit("menuItem:item-click",{index:e.index,indexPath:u,route:e.route}),t("click",{index:e.index,indexPath:u.value}))},onMouseEnter:()=>{("horizontal"!==y.value||i.props.hoverBackgroundColor)&&(l.vnode.el.style.backgroundColor=h.value)},onMouseLeave:()=>{("horizontal"!==y.value||i.props.backgroundColor)&&(l.vnode.el.style.backgroundColor=v.value)}}}});U.render=function(e,t,o,n,l,s){return r(),u("li",{class:["hkust-menu-item",{"is-active":e.active,"is-disabled":e.disabled}],role:"menuitem",tabindex:"-1",style:[e.paddingStyle,e.itemStyle,{backgroundColor:e.backgroundColor}],onClick:t[1]||(t[1]=(...t)=>e.handleClick&&e.handleClick(...t)),onMouseenter:t[2]||(t[2]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onFocus:t[3]||(t[3]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onBlur:t[4]||(t[4]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t)),onMouseleave:t[5]||(t[5]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))},[i(e.$slots,"default"),i(e.$slots,"title")],38)},U.__file="packages/menu/src/menuItem.vue",U.install=e=>{e.component(U.name,U)};const Z=U;var G;!function(e){e.DARK="dark",e.LIGHT="light"}(G||(G={}));var W={arrowOffset:{type:Number,default:5},appendToBody:{type:Boolean,default:!0},autoClose:{type:Number,default:0},boundariesPadding:{type:Number,default:0},content:{type:String,default:""},class:{type:String,default:""},style:Object,hideAfter:{type:Number,default:200},cutoff:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},effect:{type:String,default:G.DARK},enterable:{type:Boolean,default:!0},manualMode:{type:Boolean,default:!1},showAfter:{type:Number,default:0},offset:{type:Number,default:0},placement:{type:String,default:"bottom"},popperClass:{type:String,default:""},pure:{type:Boolean,default:!1},popperOptions:{type:Object,default:()=>null},showArrow:{type:Boolean,default:!0},strategy:{type:String,default:"fixed"},transition:{type:String,default:"hkust-fade-in-linear"},trigger:{type:[String,Array],default:"hover"},visible:{type:Boolean,default:void 0},stopPopperMouseEvent:{type:Boolean,default:!0},gpuAcceleration:{type:Boolean,default:!0},fallbackPlacements:{type:Array,default:[]}};"production"===process.env.NODE_ENV||Object.freeze({}),"production"===process.env.NODE_ENV||Object.freeze([]);const X=()=>{},J=Array.isArray,Q=Object.prototype.toString,Y=e=>(e=>Q.call(e))(e).slice(8,-1),ee=e=>"boolean"==typeof e;var te="undefined"==typeof window;let oe={};const ne=function(e,t,o,n=!1){e&&t&&o&&e.addEventListener(t,o,n)};function le(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}function se(e,t){if(!e)return;let o=e.className;const n=(t||"").split(" ");for(let t=0,l=n.length;t<l;t++){const l=n[t];l&&(e.classList?e.classList.add(l):le(e,l)||(o+=" "+l))}e.classList||(e.className=o)}function ae(e,t){if(!e||!t)return;const o=t.split(" ");let n=" "+e.className+" ";for(let t=0,l=o.length;t<l;t++){const l=o[t];l&&(e.classList?e.classList.remove(l):le(e,l)&&(n=n.replace(" "+l+" "," ")))}e.classList||(e.className=(n||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,""))}const re=e=>e.stopPropagation(),ue=e=>{e.preventDefault(),e.stopPropagation()},ie=()=>{null==he||he.doOnModalClick()};let de,ce=!1;const pe=function(){if(te)return;let e=he.modalDom;return e?ce=!0:(ce=!1,e=document.createElement("div"),he.modalDom=e,ne(e,"touchmove",ue),ne(e,"click",ie)),e},me={},he={modalFade:!0,modalDom:void 0,zIndex:de,getInstance:function(e){return me[e]},register:function(e,t){e&&t&&(me[e]=t)},deregister:function(e){e&&(me[e]=null,delete me[e])},nextZIndex:function(){return++he.zIndex},modalStack:[],doOnModalClick:function(){const e=he.modalStack[he.modalStack.length-1];if(!e)return;const t=he.getInstance(e.id);t&&t.closeOnClickModal.value&&t.close()},openModal:function(e,t,o,n,l){if(te)return;if(!e||void 0===t)return;this.modalFade=l;const s=this.modalStack;for(let t=0,o=s.length;t<o;t++){if(s[t].id===e)return}const a=pe();if(se(a,"v-modal"),this.modalFade&&!ce&&se(a,"v-modal-enter"),n){n.trim().split(/\s+/).forEach((e=>se(a,e)))}setTimeout((()=>{ae(a,"v-modal-enter")}),200),o&&o.parentNode&&11!==o.parentNode.nodeType?o.parentNode.appendChild(a):document.body.appendChild(a),t&&(a.style.zIndex=String(t)),a.tabIndex=0,a.style.display="",this.modalStack.push({id:e,zIndex:t,modalClass:n})},closeModal:function(e){const t=this.modalStack,o=pe();if(t.length>0){const n=t[t.length-1];if(n.id===e){if(n.modalClass){n.modalClass.trim().split(/\s+/).forEach((e=>ae(o,e)))}t.pop(),t.length>0&&(o.style.zIndex=t[t.length-1].zIndex)}else for(let o=t.length-1;o>=0;o--)if(t[o].id===e){t.splice(o,1);break}}0===t.length&&(this.modalFade&&se(o,"v-modal-leave"),setTimeout((()=>{0===t.length&&(o.parentNode&&o.parentNode.removeChild(o),o.style.display="none",he.modalDom=void 0),ae(o,"v-modal-leave")}),200))}};Object.defineProperty(he,"zIndex",{configurable:!0,get:()=>(void 0===de&&(de=oe["zIndex"]||2e3),de),set(e){de=e}});function ve(e,t=[]){const{arrow:o,arrowOffset:n,offset:l,gpuAcceleration:s,fallbackPlacements:a}=e,r=[{name:"offset",options:{offset:[0,null!=l?l:8]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:null!=a?a:[]}},{name:"computeStyles",options:{gpuAcceleration:s,adaptive:s}}];return o&&r.push({name:"arrow",options:{element:o,padding:null!=n?n:5}}),r.push(...t),r}te||ne(window,"keydown",(function(e){if(e.code===$){const e=function(){if(!te&&he.modalStack.length>0){const e=he.modalStack[he.modalStack.length-1];if(!e)return;return he.getInstance(e.id)}}();e&&e.closeOnPressEscape.value&&(e.handleClose?e.handleClose():e.handleAction?e.handleAction("cancel"):e.close())}}));function fe(e,{emit:o}){const l=t(null),s=t(null),a=t(null),r=`hkust-popper-${Math.floor(1e4*Math.random())}`;let u=null,i=null,d=null,c=!1;const v=()=>e.manualMode||"manual"===e.trigger,f=t({zIndex:he.nextZIndex()}),b=function(e,t){return n((()=>{var o;return Object.assign(Object.assign({placement:e.placement},e.popperOptions),{modifiers:ve({arrow:t.arrow.value,arrowOffset:e.arrowOffset,offset:e.offset,gpuAcceleration:e.gpuAcceleration,fallbackPlacements:e.fallbackPlacements},null===(o=e.popperOptions)||void 0===o?void 0:o.modifiers)})}))}(e,{arrow:l}),g=p({visible:!!e.visible}),y=n({get:()=>!e.disabled&&(ee(e.visible)?e.visible:g.visible),set(t){v()||(ee(e.visible)?o("update:visible",t):g.visible=t)}});function k(){e.autoClose>0&&(d=window.setTimeout((()=>{M()}),e.autoClose)),y.value=!0}function M(){y.value=!1}function x(){clearTimeout(i),clearTimeout(d)}const C=()=>{v()||e.disabled||(x(),0===e.showAfter?k():i=window.setTimeout((()=>{k()}),e.showAfter))},S=()=>{v()||(x(),e.hideAfter>0?d=window.setTimeout((()=>{I()}),e.hideAfter):I())},I=()=>{M(),e.disabled&&T(!0)};function w(){if(!h(y))return;const e=h(s),t=Y(e).startsWith("HTML")?e:e.$el;u=O(t,h(a),h(b)),u.update()}function T(e){!u||h(y)&&!e||E()}function E(){var e;null===(e=null==u?void 0:u.destroy)||void 0===e||e.call(u),u=null}const B={};if(!v()){const t=()=>{h(y)?S():C()},o=e=>{switch(e.stopPropagation(),e.type){case"click":c?c=!1:t();break;case"mouseenter":C();break;case"mouseleave":S();break;case"focus":c=!0,C();break;case"blur":c=!1,S()}},n={click:["onClick"],hover:["onMouseenter","onMouseleave"],focus:["onFocus","onBlur"]},l=e=>{n[e].forEach((e=>{B[e]=o}))};J(e.trigger)?Object.values(e.trigger).forEach(l):l(e.trigger)}return m(b,(e=>{u&&(u.setOptions(e),u.update())})),m(y,(function(e){e&&(f.value.zIndex=he.nextZIndex(),w())})),{update:function(){h(y)&&(u?u.update():w())},doDestroy:T,show:C,hide:S,onPopperMouseEnter:function(){e.enterable&&"click"!==e.trigger&&clearTimeout(d)},onPopperMouseLeave:function(){const{trigger:t}=e;"string"==typeof t&&("click"===t||"focus"===t)||1===t.length&&("click"===t[0]||"focus"===t[0])||S()},onAfterEnter:()=>{o("after-enter")},onAfterLeave:()=>{E(),o("after-leave")},onBeforeEnter:()=>{o("before-enter")},onBeforeLeave:()=>{o("before-leave")},initializePopper:w,isManualMode:v,arrowRef:l,events:B,popperId:r,popperInstance:u,popperRef:a,popperStyle:f,triggerRef:s,visibility:y}}class be extends Error{constructor(e){super(e),this.name="HkustUIError"}}function ge(e,t){if(!(e=>e.type===k)(e))return(e=>e.type===M)(e)||(e=>"template"===e.type)(e)?t>0?ye(e.children,t-1):void 0:e}const ye=(e,t=3)=>Array.isArray(e)?ge(e[0],t):ge(e,t);function ke(e,t){const o=ye(e,1);return o||((e,t)=>{throw new be(`[${e}] ${t}`)})("renderTrigger","trigger expects single rooted node"),x(o,t,!0)}const Me=new Map;let xe;function Ce(e,t){let o=[];return Array.isArray(t.arg)?o=t.arg:o.push(t.arg),function(n,l){const s=t.instance.popperRef,a=n.target,r=null==l?void 0:l.target,u=!t||!t.instance,i=!a||!r,d=e.contains(a)||e.contains(r),c=e===a,p=o.length&&o.some((e=>null==e?void 0:e.contains(a)))||o.length&&o.includes(r),m=s&&(s.contains(a)||s.contains(r));u||i||d||c||p||m||t.value(n,l)}}te||(ne(document,"mousedown",(e=>xe=e)),ne(document,"mouseup",(e=>{for(const{documentHandler:t}of Me.values())t(e,xe)})));const Se={beforeMount(e,t){Me.set(e,{documentHandler:Ce(e,t),bindingFn:t.value})},updated(e,t){Me.set(e,{documentHandler:Ce(e,t),bindingFn:t.value})},unmounted(e){Me.delete(e)}};var Ie=e({name:"HkustPopper",props:W,setup(e,t){const o=fe(e,t),n=()=>o.doDestroy(!0);return s(o.initializePopper),c(n),C(o.initializePopper),S(n),o},render(){var e;const{$slots:t,appendToBody:o,class:n,style:l,effect:s,hide:a,onPopperMouseEnter:r,onPopperMouseLeave:u,onAfterEnter:d,onAfterLeave:c,onBeforeEnter:p,onBeforeLeave:m,popperClass:h,popperId:x,popperStyle:C,pure:S,showArrow:T,transition:E,visibility:B,stopPopperMouseEvent:P}=this,O=this.isManualMode(),A=function(e){return e?v("div",{ref:"arrowRef",class:"hkust-popper__arrow","data-popper-arrow":""},null):v(k,null,"")}(T),N=null===(e=t.trigger)||void 0===e?void 0:e.call(t),z=Object.assign({"aria-describedby":x,class:n,style:l,ref:"triggerRef"},this.events),L=O?ke(N,z):g(ke(N,z),[[Se,a]]),H=function(e,t){const{effect:o,name:n,stopPopperMouseEvent:l,popperClass:s,popperStyle:a,popperRef:r,pure:u,popperId:i,visibility:d,onMouseenter:c,onMouseleave:p,onAfterEnter:m,onAfterLeave:h,onBeforeEnter:k,onBeforeLeave:M}=e,x=[s,"hkust-popper","is-"+o,u?"is-pure":""],C=l?re:X;return v(f,{name:n,onAfterEnter:m,onAfterLeave:h,onBeforeEnter:k,onBeforeLeave:M},{default:b((()=>[g(v("div",{"aria-hidden":String(!d),class:x,style:null!=a?a:{},id:i,ref:null!=r?r:"popperRef",role:"tooltip",onMouseenter:c,onMouseleave:p,onClick:re,onMousedown:C,onMouseup:C},t),[[y,d]])]))})}({effect:s,name:E,popperClass:h,popperId:x,popperStyle:C,pure:S,stopPopperMouseEvent:P,onMouseenter:r,onMouseleave:u,onAfterEnter:d,onAfterLeave:c,onBeforeEnter:p,onBeforeLeave:m,visibility:B},[i(t,"default",{},(()=>[I(this.content)])),A]);return v(M,null,[L,v(w,{to:"body",disabled:!o},[H])])}});Ie.__file="packages/popper/src/index.vue",Ie.install=e=>{e.component(Ie.name,Ie)};const we=Ie;var Te=e({name:"HkustSubmenu",componentName:"HkustSubmenu",props:{index:{type:String,required:!0},backgroundColor:String,popperClass:String,popperAppendToBody:{type:Boolean,default:void 0},showIcon:{type:Boolean,default:!0},disabled:Boolean,offset:Number,placement:String,showTimeout:Number,hideTimeout:Number},setup(e){const a=o(),{paddingStyle:r,indexPath:u,parentMenu:i}=K(a,e.index),m=d("rootMenu"),h=d(`submenu:${i.value.uid}`),v=p({items:{},submenus:{},currentPlacement:"",mouseInChild:!1}),f=P(),b=t(null),g=t(null),y=n((()=>m.props.mode)),k=n((()=>e.placement||m.props.placement||"bottom-start")),M=n((()=>{const e=v.items,t=v.submenus;return!!Object.keys(e).some((t=>e[t].active))||!!Object.keys(t).some((e=>t[e].active))})),x=n((()=>m.openedMenus.value.includes(e.index))),C=n((()=>{let e=!0,t=a.parent;for(;t&&"HkustMenu"!==t.type.name;){if(["HkustSubmenu","HkustMenuItemGroup"].includes(t.type.name)){e=!1;break}t=t.parent}return e})),S=n((()=>"horizontal"===y.value&&C.value||"vertical"===y.value&&!m.props.collapse?"hkust-icon-arrow-down-bold":"hkust-icon-arrow-right-bold")),I=n((()=>"horizontal"!==y.value?{color:m.props.textColor||""}:{borderBottomColor:M.value?m.props.activeTextColor||"":"transparent",color:M.value?m.props.activeTextColor:m.props.textColor})),w=n((()=>void 0===e.popperAppendToBody?C.value:Boolean(e.popperAppendToBody))),E=n((()=>m.props.collapse?"hkust-zoom-in-left":"hkust-zoom-in-top")),B=n((()=>e.showTimeout||m.props.showTimeout)),O=n((()=>e.hideTimeout||m.props.hideTimeout)),A=n((()=>e.offset||m.props.offset)),N=n((()=>e.backgroundColor||m.props.backgroundColor)),z=(t=!1)=>{"click"===m.props.menuTrigger&&"horizontal"===m.props.mode||!m.props.collapse&&"vertical"===m.props.mode||(f.emit("submenu:mouse-leave-child"),setTimeout((()=>{!v.mouseInChild&&m.methods.closeMenu(e.index)}),O.value),w.value&&t&&"HkustSubmenu"===a.parent.type.name&&h.handleMouseleave(!0))},L=e=>{v.items[e.index]=e},H=e=>{delete v.items[e.index]};return l(`submenu:${a.uid}`,{addSubMenu:e=>{v.submenus[e.index]=e},removeSubMenu:e=>{delete v.submenus[e.index]},handleMouseleave:z,addMenuItem:L,removeMenuItem:H}),T((()=>{f.on("submenu:mouse-enter-child",(()=>{v.mouseInChild=!0})),f.on("submenu:mouse-leave-child",(()=>{v.mouseInChild=!1}))})),s((()=>{m.methods.addSubMenu({index:e.index,indexPath:u,active:M}),h&&h.addSubMenu({index:e.index,indexPath:u,active:M}),v.currentPlacement="horizontal"===y.value&&C.value?k.value:"right-start"})),c((()=>{m.methods.removeSubMenu({index:e.index,indexPath:u,active:M}),h&&h.removeSubMenu({index:e.index,indexPath:u,active:M})})),{state:v,mode:y,rootMenu:m,submenuOffset:A,rootBackgroundColor:m.props.backgroundColor,submenuBackgroundColor:N,active:M,opened:x,appendToBody:w,titleIcon:S,titleStyle:I,paddingStyle:r,verticalTitleRef:g,addMenuItem:L,removeMenuItem:H,handleMouseenter:t=>{("ActiveXObject"in window||"focus"!==t.type||t.relatedTarget)&&("click"===m.props.menuTrigger&&"horizontal"===m.props.mode||!m.props.collapse&&"vertical"===m.props.mode||e.disabled||(f.emit("submenu:mouse-enter-child"),setTimeout((()=>{m.methods.openMenu(e.index,u)}),B.value),w.value&&i.value.vnode.el.dispatchEvent(new MouseEvent("mouseenter"))))},handleMouseleave:z,handleClick:()=>{"hover"===m.props.menuTrigger&&"horizontal"===m.props.mode||m.props.collapse&&"vertical"===m.props.mode||e.disabled||m.rootMenuEmit("submenu:submenu-click",{index:e.index,indexPath:u})},handleTitleMouseenter:()=>{var e;if("horizontal"===y.value&&!m.props.hoverBackgroundColor)return;const t=(null===(e=b.value)||void 0===e?void 0:e.triggerRef)||g.value;t&&(t.style.backgroundColor=m.props.hoverBackgroundColor)},handleTitleMouseleave:()=>{var e;if("horizontal"===y.value&&!m.props.hoverBackgroundColor)return;const t=(null===(e=b.value)||void 0===e?void 0:e.triggerRef)||g.value;t&&(t.style.backgroundColor=m.props.backgroundColor||"")},isMenuPopup:m.isMenuPopup,menuTransitionName:E}},render(){var e,t,o,n,l,s;const a=[null===(t=(e=this.$slots).title)||void 0===t?void 0:t.call(e),this.$slots.icon?null===(n=(o=this.$slots).icon)||void 0===n?void 0:n.call(o):this.showIcon?v("i",{class:["hkust-submenu__icon-arrow",this.titleIcon]},null):null],r={backgroundColor:this.submenuBackgroundColor||""},u=this.isMenuPopup?v(we,{ref:"popperVNode",manualMode:!0,visible:this.opened,"onUpdate:visible":e=>this.opened=e,effect:"light",pure:!0,offset:this.submenuOffset,showArrow:!1,popperClass:this.popperClass,placement:this.state.currentPlacement,appendToBody:this.appendToBody,transition:this.menuTransitionName,gpuAcceleration:!1},{default:()=>{var e,t;return v("div",{ref:"menu",class:[`hkust-menu--${this.mode}`,this.popperClass],onMouseenter:e=>this.handleMouseenter(e,100),onMouseleave:()=>this.handleMouseleave(!0),onFocus:e=>this.handleMouseenter(e,100)},[v("ul",{class:["hkust-menu hkust-menu--popup",`hkust-menu--popup-${this.state.currentPlacement}`],style:r},[null===(t=(e=this.$slots).default)||void 0===t?void 0:t.call(e)])])},trigger:()=>v("div",{class:"hkust-submenu__title",style:[this.paddingStyle,this.titleStyle,{backgroundColor:this.rootBackgroundColor}],onClick:this.handleClick,onMouseenter:this.handleTitleMouseenter,onMouseleave:this.handleTitleMouseleave},a)}):v(M,{},[v("div",{class:"hkust-submenu__title",style:[this.paddingStyle,this.titleStyle,{backgroundColor:this.rootBackgroundColor}],ref:"verticalTitleRef",onClick:this.handleClick,onMouseenter:this.handleTitleMouseenter,onMouseleave:this.handleTitleMouseleave},a),g(v("ul",{role:"menu",class:"hkust-menu hkust-menu--inline",style:r},[null===(s=(l=this.$slots).default)||void 0===s?void 0:s.call(l)]),[[y,this.opened]])]);return v("li",{class:["hkust-submenu",{"is-active":this.active,"is-opened":this.opened,"is-disabled":this.disabled}],role:"menuitem",ariaHaspopup:!0,ariaExpanded:this.opened,onMouseenter:this.handleMouseenter,onMouseleave:()=>this.handleMouseleave(!0),onFocus:this.handleMouseenter},[u])}});Te.__file="packages/menu/src/submenu.vue",Te.install=e=>{e.component(Te.name,Te)};const Ee=Te;var Be=e({name:"HkustOverlay",props:{overlayClass:{type:()=>[String,Object,Array]},zIndex:{type:Number,default:2e3},vague:{type:Boolean,default:!0},blur:{type:String,default:"2px"},mode:{type:String,default:"fixed"},backgroundColor:String},emits:["click"],setup(e,{emit:t}){const o=n((()=>({zIndex:e.zIndex,backgroundColor:e.backgroundColor||"",position:e.mode,backdropFilter:`blur(${e.vague?e.blur:"0"})`})));return{props:e,overlayStyle:o,handleClick:e=>{t("click",e)}}}});Be.render=function(e,t,o,n,l,s){return r(),u("div",{class:["hkust-overlay",e.props.overlayClass],style:e.overlayStyle,onClick:t[1]||(t[1]=(...t)=>e.handleClick&&e.handleClick(...t))},[i(e.$slots,"default")],6)},Be.__file="packages/overlay/src/index.vue",Be.install=e=>{e.component(Be.name,Be)};const Pe=Be,Oe=[];ne(document,"keydown",(function(e){if(0!==Oe.length&&e.code===$){e.stopPropagation();Oe[Oe.length-1].handleClose()}}));var Ae=e({name:"HkustSearch",components:{HkustOverlay:Pe},props:{overlayClass:{type:()=>[String,Object,Array]},zIndex:{type:Number,default:2e3},backgroundColor:String,blur:{type:String,default:"2px"},showClose:{type:Boolean,default:!0},confirmButtonText:{type:String,default:"搜寻"},inputPlaceholder:{type:String,default:"请输入搜寻项目"},modelValue:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!0},beforeClose:{type:Function},closeOnClickModal:{type:Boolean,default:!0},closeOnpressEscape:{type:Boolean,default:!0},closeDelay:Number,openDelay:Number,vague:{type:Boolean,default:!0}},emits:["update:modelValue","confirm","input","close","open"],setup(e,{emit:o}){const n=t(!1),l=t(null),a=t(null);m((()=>e.modelValue),(e=>{e?r():i()}));const r=()=>{clearTimeout(l.value),clearTimeout(a.value),e.openDelay?(console.log("----"),a.value=setTimeout((()=>{a.value=null,u(),console.log("====")}),e.openDelay)):u()},u=()=>{n.value=!0,o("open")},i=(t=!1)=>{t||(clearTimeout(l.value),clearTimeout(a.value),e.closeDelay?l.value=setTimeout((()=>{l.value=null,d()}),e.closeDelay):d())},d=()=>{n.value=!1,o("close"),o("update:modelValue",!1)},c=()=>{e.beforeClose?e.beforeClose(i):i()};var p,h;return e.closeOnpressEscape&&(p={handleClose:c},h=n,m((()=>h.value),(e=>{e?Oe.push(p):Oe.splice(Oe.findIndex((e=>e===p)),1)}))),s((()=>{e.modelValue&&r()})),{visible:n,open:r,close:i,handleConfirm:e=>{o("confirm",e)},handleInput:e=>{o("input",e)},handleClose:c,handleModalClick:()=>{e.closeOnClickModal&&c()},preventEvent:e=>{e.preventDefault(),e.stopPropagation()}}}});const Ne={class:"hkust-search"};Ae.render=function(e,t,o,n,l,s){const a=E("hkust-overlay");return r(),u(w,{to:"body",disabled:!e.appendToBody},[g(B(a,{"append-to-body":!1,vague:e.vague,"background-color":"rgba(0,0,0,0.7)",onClick:e.handleModalClick},{default:b((()=>[B("div",Ne,[i(e.$slots,"close",{},(()=>[B("i",{class:"hkust-icon-searchclose hkust-search__close-btn",onClick:t[1]||(t[1]=(...t)=>e.handleClose&&e.handleClose(...t))})])),B("div",{class:"hkust-search__content",onClick:t[4]||(t[4]=(...t)=>e.preventEvent&&e.preventEvent(...t))},[i(e.$slots,"default",{},(()=>[B("input",{type:"text",class:"hkust-search__input",placeholder:e.inputPlaceholder,onInput:t[2]||(t[2]=(...t)=>e.handleInput&&e.handleInput(...t))},null,40,["placeholder"]),B("button",{class:"hkust-search__btn",onClick:t[3]||(t[3]=(...t)=>e.handleConfirm&&e.handleConfirm(...t))},I(e.confirmButtonText),1)]))])])])),_:3},8,["vague","onClick"]),[[y,e.visible]])],8,["disabled"])},Ae.__file="packages/search/src/index.vue",Ae.install=e=>{e.component(Ae.name,Ae)};const ze=Ae;let Le={name:"en",hkust:{demo:"demo"}};const He="0.0.1",_e=e=>{Le=e||Le,Le.name&&A.locale(Le.name)},$e={size:"",zIndex:2e3},De=[q,Z,Ee,Pe,ze];var je={version:"0.0.1",install:(e,t)=>{const o=Object.assign($e,t);_e(o.locale),o.i18n&&o.i18n,De.forEach((t=>{e.component(t.name,t)}))}};export default je;export{q as HkustMenu,Z as HkustMenuItem,Pe as HkustOverlay,ze as HkustSearch,Ee as HkustSubmenu,_e as locale,He as version};
